<app-header
  [background]="{
    'background-image': 'url(\'/assets/img/settings.jpeg\')'
  }"
></app-header>
<div class="container-xl px-4 px-lg-5">
  <div class="row gx-4 gx-lg-5 justify-content-center">
    <form [formGroup]="formGroup">
      <div>
        <article class="mb-4">
          <mat-accordion multi class="example-headers-align">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title> Services de streaming </mat-panel-title>
                <mat-panel-description
                  ><span [matTooltip]="watchProviders | map : 'provider_name'">
                    Sélectionné{{ watchProviders.length > 1 ? "s" : "" }} :
                    <span> {{ watchProviders.length }}</span>
                  </span>

                  <mat-icon>live_tv</mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>
              <app-watch-providers
                (watchProviders)="setWatchProviders($event)"
              ></app-watch-providers>
            </mat-expansion-panel>
            <!-- Genres -->

            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title> Genres</mat-panel-title>
                <mat-panel-description
                  ><span [matTooltip]="withoutGenres | map : 'name'">
                    Exclus : {{ withoutGenres.length }}</span
                  >

                  <mat-icon> swipe </mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>
              <app-genres
                (withoutGenres)="setWithoutGenres($event)"
              ></app-genres>
            </mat-expansion-panel>

            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>Pays de production</mat-panel-title>
                <mat-panel-description>
                  <mat-icon> flags </mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>
              <app-production-countries></app-production-countries>
            </mat-expansion-panel>

            <!--Misc-->
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title>Autre</mat-panel-title>
                <mat-panel-description>
                  filtres et tris divers
                  <mat-icon> settings </mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>

              <div>
                <h3>Tri et ordre</h3>
                <div class="order-and-filter">
                  <app-sort></app-sort>

                  <mat-form-field class="example-full-width">
                    <mat-label>Nombre de vote minimum</mat-label>
                    <input
                      matInput
                      type="number"
                      placeholder="Vote"
                      [value]="voteCountGte"
                      (change)="handleVoteCountGte($event)"
                    />
                  </mat-form-field>
                </div>
                <mat-divider></mat-divider>
                <div>
                  <h3>Afficher les contenus</h3>
                  <mat-checkbox
                    *ngFor="let content of displayContent"
                    [checked]="userDisplayContent.includes(content)"
                    (change)="
                      handleWithWatchMonetizationTypesCheckboxChange($event)
                    "
                    [value]="content.value"
                    >{{ content.label }}</mat-checkbox
                  >
                </div>
                <mat-divider></mat-divider>
                <div>
                  <app-certification></app-certification>
                </div>
                <mat-divider></mat-divider>
                <div class="order-and-filter">
                  <div>
                    <h3>Filter par années de sortie</h3>
                    <mat-label
                      >Années de sortie comprises entre
                      {{ formGroup.value.releaseDates?.start }} et
                      {{ formGroup.value.releaseDates?.end }}</mat-label
                    >
                    <div>
                      <mat-slider
                        formGroupName="releaseDates"
                        min="1895"
                        max="2024"
                      >
                        <input
                          matSliderStartThumb
                          formControlName="start"
                          (change)="handleReleaseDatesChanges()"
                        />
                        <input
                          matSliderEndThumb
                          formControlName="end"
                          (change)="handleReleaseDatesChanges()"
                        />
                      </mat-slider>
                    </div>
                  </div>
                  <div>
                    <h3>Filter par durée</h3>
                    <mat-label
                      >Durée des films comprise entre
                      {{ runtimeLabel() }}</mat-label
                    >
                    <div>
                      <mat-slider formGroupName="runtime" min="0" max="300">
                        <input
                          matSliderStartThumb
                          formControlName="start"
                          (change)="handleRuntimeChanges()"
                        />
                        <input
                          matSliderEndThumb
                          formControlName="end"
                          (change)="handleRuntimeChanges()"
                        />
                      </mat-slider>
                    </div>
                  </div>
                </div>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </article>
      </div>
    </form>
  </div>
</div>
