<app-header></app-header>
<div class="container px-4 px-lg-5">
  <div class="row gx-4 gx-lg-5 justify-content-center">
    <form [formGroup]="formGroup">
      <div>
        <article class="mb-4">
          <mat-accordion multi class="example-headers-align">
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title> Services de streaming </mat-panel-title>
                <mat-panel-description
                  ><span [matTooltip]="watchProviders | map : 'provider_name'">
                    Sélectionné{{ watchProviders.length > 1 ? "s" : "" }} :
                    <span> {{ watchProviders.length }}</span>
                  </span>

                  <mat-icon>live_tv</mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>
              <app-watch-providers
                (watchProviders)="setWatchProviders($event)"
              ></app-watch-providers>
            </mat-expansion-panel>
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title> Genres</mat-panel-title>
                <mat-panel-description
                  ><span [matTooltip]="withoutGenres | map : 'name'">
                    Exclus : {{ withoutGenres.length }}</span
                  >

                  <mat-icon> swipe </mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>
              <app-genres
                (withoutGenres)="setWithoutGenres($event)"
              ></app-genres>
            </mat-expansion-panel>

            <!--Misc-->
            <mat-expansion-panel>
              <mat-expansion-panel-header>
                <mat-panel-title> Autre</mat-panel-title>
                <mat-panel-description>
                  filtres et tris divers
                  <mat-icon> settings </mat-icon></mat-panel-description
                >
              </mat-expansion-panel-header>

              <div>
                <h3>Tri et ordre</h3>
                <div class="order-and-filter">
                  <mat-form-field class="mr-2">
                    <mat-label>Trier par</mat-label>
                    <mat-select
                      [value]="orderBySelectValue"
                      (valueChange)="handleOrderByChange($event)"
                    >
                      <mat-option value="popularity">Popularité</mat-option>
                      <mat-option value="revenue">Revenu</mat-option>
                      <mat-option value="primary_release_date"
                        >Date de Réalisation</mat-option
                      >
                      <mat-option value="title">Ordre alphabétique</mat-option>
                      <mat-option value="vote_average">Note</mat-option>
                      <mat-option value="vote_count">Nombre de vote</mat-option>
                    </mat-select>
                    <button
                      mat-icon-button
                      (click)="toggleSortOrder()"
                      matSuffix
                    >
                      <mat-icon>{{
                        sortOrder === "asc" ? "arrow_upward" : "arrow_downward"
                      }}</mat-icon>
                    </button>
                  </mat-form-field>

                  <mat-form-field class="example-full-width">
                    <mat-label>Nombre de vote minimum</mat-label>
                    <input
                      matInput
                      type="number"
                      placeholder="Vote"
                      [value]="voteCountGte"
                      (change)="handleVoteCountGte($event)"
                    />
                  </mat-form-field>
                </div>
                <mat-divider></mat-divider>
                <div>
                  <h3>Afficher les contenus</h3>
                  <mat-checkbox
                    *ngFor="let content of displayContent"
                    [checked]="userDisplayContent.includes(content)"
                    (change)="
                      handleWithWatchMonetizationTypesCheckboxChange($event)
                    "
                    [value]="content.value"
                    >{{ content.label }}</mat-checkbox
                  >
                </div>
                <mat-divider></mat-divider>
                <div>
                  <div>
                    <h3>Limite d'âge</h3>
                    <mat-radio-group
                      formControlName="selectedAge"
                      (change)="handleAgeLimitChange($event)"
                    >
                      <mat-radio-button
                        value="0"
                        [checked]="'0' === userCertificationLte"
                        >Aucune</mat-radio-button
                      >

                      <mat-radio-button
                        value="TP"
                        [checked]="'TP' === userCertificationLte"
                        matTooltip="programme télévisé qui est considéré comme adapté à un large public, y compris aux enfants et aux adultes. Il est conçu de manière à ne pas contenir de contenu inapproprié ou choquant pour les jeunes spectateurs. "
                        >Tous public</mat-radio-button
                      >
                      <mat-radio-button
                        value="12"
                        [checked]="'12' === userCertificationLte"
                        matTooltip="Programmes comportant de la violence physique et/ou psychologique de façon répétée ou des scènes relatives à la sexualité des adultes. "
                        >- 12 ans</mat-radio-button
                      >
                      <mat-radio-button
                        value="16"
                        [checked]="'16' === userCertificationLte"
                        matTooltip="Programmes érotiques ou ceux comportant des scènes de grande violence"
                        >- 16 ans</mat-radio-button
                      >
                      <mat-radio-button
                        value="18"
                        [checked]="'18' === userCertificationLte"
                        matTooltip="Programmes d’ordre pornographique ou de très grande violence réservés à un public adulte averti."
                        >- 18 ans</mat-radio-button
                      >
                    </mat-radio-group>
                    <blockquote>
                      Veuillez noter que selon certains services de streaming,
                      les classifications par âge des contenus peuvent varier.
                    </blockquote>
                  </div>
                </div>
                <mat-divider></mat-divider>
                <div class="order-and-filter">
                  <div>
                    <h3>Filter par années de sortie</h3>
                    <mat-label
                      >Années de sortie comprises entre
                      {{ formGroup.value.releaseDates?.start }} et
                      {{ formGroup.value.releaseDates?.end }}</mat-label
                    >
                    <div>
                      <mat-slider
                        formGroupName="releaseDates"
                        min="1895"
                        max="2024"
                      >
                        <input
                          matSliderStartThumb
                          formControlName="start"
                          (change)="handleReleaseDatesChanges()"
                        />
                        <input
                          matSliderEndThumb
                          formControlName="end"
                          (change)="handleReleaseDatesChanges()"
                        />
                      </mat-slider>
                    </div>
                  </div>
                  <div>
                    <h3>Filter par durée</h3>
                    <mat-label
                      >Durée des films comprise entre
                      {{ runtimeLabel() }}</mat-label
                    >
                    <div>
                      <mat-slider formGroupName="runtime" min="0" max="300">
                        <input
                          matSliderStartThumb
                          formControlName="start"
                          (change)="handleRuntimeChanges()"
                        />
                        <input
                          matSliderEndThumb
                          formControlName="end"
                          (change)="handleRuntimeChanges()"
                        />
                      </mat-slider>
                    </div>
                  </div>
                </div>
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </article>
      </div>
    </form>
  </div>
</div>
